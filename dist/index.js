function r(){return r=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var s in e)({}).hasOwnProperty.call(e,s)&&(r[s]=e[s])}return r},r.apply(null,arguments)}class t{constructor(r,t,e,s,i,n,o){this.name=r,this.uri=t,this.methods=e,this.parameters=s,this.missingParameters=[],this.bindings=i,this.incomingParameters=n||{},this.config=o}resolveRouteParameters(r){return Object.entries(this.incomingParameters).forEach(([t,e])=>{if(this.parameters.includes(t))if("object"!=typeof e)r=r.replace(`{${t}}`,e);else{const s=this.bindings[t];if(!s)throw new Error(`Plum error: route '${this.name}' has no binding for parameter '${t}'.`);r=r.replace(`{${t}}`,e[s])}else this.missingParameters.push(t)}),r}resolveMissingParameters(r){return 0===this.missingParameters.length||this.missingParameters.forEach(t=>{const e=this.incomingParameters[t];if("object"==typeof e)throw new Error(`Plum error: missing parameter '${t}' has an invalid value.`);r.searchParams.append(t,e)}),r}compile(){const r=this.resolveRouteParameters(this.uri),t=new URL(r,this.config.url);return this.url=this.resolveMissingParameters(t),this}toString(){if(!this.url)throw new Error(`Plum error: route '${this.name}' is not compiled.`);return this.url.href}}class e{constructor(t,e,s=!0,i){this.name=t,this.incomingParameters=e,this.config=i||"undefined"!=typeof plum?plum:globalThis.plum,this.config=r({},this.config,{absolute:s})}has(r){return this.config.routes.hasOwnProperty(r)}fetchRoute(){if(!this.has(this.name))throw new Error(`Plum error: route '${this.name}' is not in the route list.`);const r=this.config.routes[this.name];return new t(this.name,r.uri,r.methods,r.parameters||[],r.bindings||{},this.incomingParameters,{url:this.config.url,port:this.config.port,defaults:this.config.defaults,absolute:this.config.absolute})}}function s(r,t,s,i){const n=new e(r,t,s,i);return r||t||s||i?n.fetchRoute().compile().toString():{has:r=>n.has(r)}}const i={install(r,t){function e(r,e,i,n=t){return s(r,e,i,n)}r.config.globalProperties.route=e,r.provide("route",e)}};export{i as PlumVue,s as route};
