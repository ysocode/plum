function r(){return r=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},r.apply(null,arguments)}var e=["_query"],t=/*#__PURE__*/function(){function r(r,e,t,i,n,s,a){this.name=r||null,this.uri=e||null,this.methods=t||[],this.parameters=i||[],this.missingParameters=[],this.bindings=n||{},this.config=a||{},this.setParameters(s||{})}var t=r.prototype;return t.setParameters=function(r){var t=r||{},i=t._query,n=function(r,e){if(null==r)return{};var t={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;t[i]=r[i]}return t}(t,e);this.queryParameters=i||{},this.incomingParameters=n||{}},t.getBinding=function(r,e){void 0===e&&(e=!0);var t=this.bindings[r];if(!t){if(!e)return null;throw new Error("Plum error: route '"+this.name+"' has no binding for parameter '"+r+"'.")}return t},t.resolveRouteParameters=function(r){var e=this;return Object.entries(this.config.defaults).forEach(function(t){var i=t[0],n=t[1];if("object"!=typeof n)r=r.replace("{"+i+"}",n);else{var s=e.getBinding(i,!1);if(!s)return;r=r.replace("{"+i+"}",n[s])}}),Object.entries(this.incomingParameters).forEach(function(t){var i=t[0],n=t[1];if(e.parameters.includes(i)||e.config.defaults.hasOwnProperty(i))if("object"!=typeof n)r=r.replace("{"+i+"}",n);else{var s=e.getBinding(i);r=r.replace("{"+i+"}",n[s])}else e.missingParameters.push(i)}),r},t.convertQueryParameters=function(r){var e={boolean:function(r){return r?1:0}}[typeof r];return e?e(r):r},t.resolveMissingParameters=function(r){var e=this;return 0===this.missingParameters.length||this.missingParameters.forEach(function(t){var i=e.incomingParameters[t];if("object"==typeof i)throw new Error("Plum error: missing parameter '"+t+"' has an invalid value.");r.searchParams.append(t,e.convertQueryParameters(i))}),r},t.resolveQueryParameters=function(r){var e=this;return Object.entries(this.queryParameters).forEach(function(t){var i=t[0],n=t[1];if("object"==typeof n)throw new Error("Plum error: missing parameter '"+i+"' has an invalid value.");r.searchParams.append(i,e.convertQueryParameters(n))}),r},t.compile=function(){var r=this.resolveRouteParameters(this.uri);return this.url=new URL(r,this.config.url),this.url=this.resolveMissingParameters(this.url),this.url=this.resolveQueryParameters(this.url),this},t.toString=function(){if(!this.url)throw new Error("Plum error: route '"+this.name+"' is not compiled.");return this.config.absolute?this.url.href:this.url.pathname+this.url.search+this.url.hash},r}(),i=/*#__PURE__*/function(){function e(e,t,i,n){void 0===i&&(i=!0),this.name=e||null,this.incomingParameters=t||{},this.config=n||"undefined"!=typeof plum?plum:globalThis.plum,this.config=r({},this.config,{absolute:i})}var i=e.prototype;return i.has=function(r){return this.config.routes.hasOwnProperty(r)},i.fetchRoute=function(){if(!this.has(this.name))throw new Error("Plum error: route '"+this.name+"' is not in the route list.");var r=this.config.routes[this.name];return new t(this.name,r.uri,r.methods,r.parameters,r.bindings,this.incomingParameters,{url:this.config.url,port:this.config.port,defaults:this.config.defaults,absolute:this.config.absolute})},e}();function n(r,e,t,n){var s=new i(r,e,t,n);return r||e||t||n?s.fetchRoute().compile().toString():{has:function(r){return s.has(r)}}}var s={install:function(r,e){function t(r,t,i,s){return void 0===s&&(s=e),n(r,t,i,s)}r.config.globalProperties.route=t,r.provide("route",t)}};export{s as PlumVue,n as route};
