var r=["_query","_fragment"],e=/*#__PURE__*/function(){function e(r,e,t,i,n,s,o){this.setName(r),this.setUri(e),this.methods=t||[],this.parameters=i||[],this.bindings=n||{},this.setParameters(s||{}),this.config=o||{},this.setUrl(this.config.url),this.missingParameters=[]}var t=e.prototype;return t.setName=function(r){if("string"!=typeof r)throw new TypeError("The name parameter must be a string");this.name=r},t.setUri=function(r){if("string"!=typeof r)throw new TypeError("The uri parameter must be a string");this.uri="/"===r?"":r},t.setUrl=function(r){if("string"!=typeof r)throw new TypeError("The url parameter must be a string");this.url=new URL(r)},t.setParameters=function(e){if("object"!=typeof e)throw new TypeError("The parameters parameter must be an object");var t=e||{},i=t._query,n=t._fragment,s=function(r,e){if(null==r)return{};var t={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;t[i]=r[i]}return t}(t,r);this.queryParameters=i||{},this.fragment=n||null,this.incomingParameters=s||{}},t.getBinding=function(r){return this.bindings[r]||null},t.resolveRouteParameters=function(r){var e=this;if("string"!=typeof r)throw new TypeError("The uri parameter must be a string");return Object.entries(this.config.defaults).forEach(function(t){var i=t[0],n=t[1];if("object"!=typeof n)r=r.replace("{"+i+"}",n.toString());else{var s=e.getBinding(i);if(!s)return;r=r.replace("{"+i+"}",n[s].toString())}}),Object.entries(this.incomingParameters).forEach(function(t){var i=t[0],n=t[1];if(e.parameters.includes(i)||e.config.defaults.hasOwnProperty(i))if("object"!=typeof n)r=r.replace("{"+i+"}",n.toString());else{var s=e.getBinding(i);if(!s)throw new Error("Plum error: route '"+e.name+"' has no binding for parameter '"+i+"'.");r=r.replace("{"+i+"}",n[s].toString())}else e.missingParameters.push(i)}),r},t.convertQueryParameters=function(r){var e={boolean:function(r){return r?1:0}}[typeof r];return e?e(r):r},t.resolveMissingParameters=function(r){var e=this;if("object"!=typeof r)throw new TypeError("The url parameter must be an object");return this.missingParameters.length<1||this.missingParameters.forEach(function(t){var i=e.incomingParameters[t];if("object"==typeof i)throw new Error("Plum error: missing parameter '"+t+"' has an invalid value.");r.searchParams.append(t,e.convertQueryParameters(i).toString())}),r},t.resolveQueryParameters=function(r){var e=this;if("object"!=typeof r)throw new TypeError("The url parameter must be an object");return Object.entries(this.queryParameters).forEach(function(t){var i=t[0],n=t[1];if("object"==typeof n)throw new Error("Plum error: missing parameter '"+i+"' has an invalid value");r.searchParams.append(i,e.convertQueryParameters(n).toString())}),r},t.resolveFragment=function(r){return this.fragment?(r.hash=this.fragment,r):r},t.compile=function(){return this.url.pathname=this.resolveRouteParameters(this.uri),this.url=this.resolveMissingParameters(this.url),this.url=this.resolveQueryParameters(this.url),this.url=this.resolveFragment(this.url),this.compiled=!0,this},t.toString=function(){if(!this.compiled)throw new Error("Plum error: route '"+this.name+"' is not compiled");return this.config.absolute?this.url.href:this.url.pathname+this.url.search+this.url.hash},e}(),t=/*#__PURE__*/function(){function r(r,e,t,i){this.setUrl(r),this.setPort(e),this.defaults=t||{},this.routes=i||{}}var t=r.prototype;return t.setUrl=function(r){if("string"!=typeof r)throw new TypeError("The url parameter must be a string");this.url=r},t.setPort=function(r){if("number"!=typeof r)throw new TypeError("The port parameter must be a number");this.port=r},t.has=function(r){return this.routes.hasOwnProperty(r)},t.fetchRoute=function(r,t,i){if(void 0===t&&(t={}),void 0===i&&(i=!0),!this.has(r))throw new Error("Plum error: route '"+r+"' is not in the route list.");var n=this.routes[r];return new e(r,n.uri,n.methods,n.parameters,n.bindings,t,{url:this.url,port:this.port,defaults:this.defaults,absolute:i})},r}();function i(r,e,i){void 0===e&&(e={}),void 0===i&&(i=!0);var n=("undefined"!=typeof plum?plum:globalThis.plum)||null;if("object"!=typeof n)throw new Error("Unable to find Plum");var s=new t(n.url,parseInt(n.port),n.defaults,n.routes);return r||e||i?s.fetchRoute(r,e,i).compile().toString():{has:function(r){return s.has(r)}}}var n={install:function(r){function e(r,e,t){return i(r,e,t)}r.config.globalProperties.route=e,r.provide("route",e)}};export{n as PlumVue,i as route};
